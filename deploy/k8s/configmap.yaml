apiVersion: v1
kind: ConfigMap
metadata:
  name: access-control-config
  namespace: access-control
data:
  config.yaml: |
    Name: access-control-api
    Host: 0.0.0.0
    Port: 8080
    
    # 日志配置
    Log:
      Mode: file
      Path: /var/log/access-control
      Level: error
      Compress: true
      KeepDays: 30
      Stat: true
    
    # 服务配置
    MaxConns: 10000
    MaxBytes: 1048576
    Timeout: 30000
    
    # 数据库配置 - 使用环境变量
    Database:
      Host: ${DB_HOST}
      Port: ${DB_PORT}
      User: ${DB_USER}
      Password: ${DB_PASSWORD}
      DBName: ${DB_NAME}
      SSLMode: require
      MaxOpenConns: 100
      MaxIdleConns: 10
      ConnMaxLifetime: 3600
    
    # Redis配置
    Redis:
      Host: ${REDIS_HOST}:${REDIS_PORT}
      Password: ${REDIS_PASSWORD}
      DB: 0
      MaxRetries: 3
      PoolSize: 100
      MinIdleConns: 10
    
    # JWT配置
    Auth:
      AccessSecret: ${JWT_SECRET}
      AccessExpire: 86400
    
    # Prometheus 指标
    Prometheus:
      Host: 0.0.0.0
      Port: 9090
      Path: /metrics
